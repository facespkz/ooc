<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' lang='' xml:lang=''>
    <head>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width, user-scalable=no' />
		<link id='-gd-engine-icon' rel='icon' type='image/png' href='favicon.png' />
        <title>$GODOT_PROJECT_NAME</title>
        <meta charset="UTF-8">
        $GODOT_HEAD_INCLUDE
    </head>
    <body>
        <canvas id="canvas"></canvas>
        <script src="$GODOT_URL"></script>
        <script>
            var engine = new Engine($GODOT_CONFIG);
            engine.startGame();
        </script>
        <!--
       	glue code to handle file uploading w/ Godot
       	-->
       	<script type='text/javascript'>
       		// Godot will poll this to make sure files are uploaded
       		var pokeftrSelected,
       			pokeftrFiles,
       			pokeftrFileNames,
       			pokeftrInput = document.createElement('input');
       		
       		function pokeftrGlueReset() {
       			pokeftrSelected = false;
       			pokeftrFiles = [];
       			pokeftrFileNames = [];
       			console.log('is reset')
       		}
       		pokeftrGlueReset();
       		
       		pokeftrInput.type = 'file';
       		pokeftrInput.style = 'display: none';
       		pokeftrInput.accept = 'image/png';
       		pokeftrInput.multiple = true;
       		
       		pokeftrInput.onclick = pokeftrGlueReset;
       
       		pokeftrInput.oninput = function(e) {
       			
       			for (idx = 0; idx < pokeftrInput.files.length; idx++) {
       				
       				let reader = new FileReader();
       				let file = pokeftrInput.files[idx];
       				reader.readAsArrayBuffer(file);
       				
       				reader.onload = function(e) {
       					
       					pokeftrFiles.push(e.target.result);
       					pokeftrFileNames.push(file.name);
       					
       				}
       			}
       			pokeftrSelected = true;
       			
       		}
       	</script>
    </body>
</html>
